Слайд7:

Наши все предыдущие реализации использовали параллельную версию FFTW, но у FFTW есть серьезное ограничение с декомпозицией.

Есть 2 разные декомпозиции показанные на слайде. 

**Slab-декомпозиция (1D):**

Данные разделяются только вдоль одного направления. Например, вдоль оси X — каждый процесс хранит плоскость YZ и может выполнять FFT по Y и Z. Для FFT по X требуется транспозиция данных.

**Pencil-декомпозиция (2D):**

Данные разделяются вдоль двух направлений. Например, вдоль X и Y — каждый процесс хранит "карандаш" данных вдоль Z. Можно последовательно выполнять FFT по Z, затем Y, затем X.

Slab-декомпозиция имеет серьезную проблему масштабируемости, поскольку разделение происходит только вдоль одного направления. Это означает, что **количество процессов не может превышать N** — размер сетки по одному измерению.  Это **масштабируемость O(N)**. 

В отличие от этого, Pencil-декомпозиция разделяет данные вдоль двух направлений, что обеспечивает значительно лучшую масштабируемость **O(N²)**.

К сожадению библиотека FFTW использует только Slab decomposition.

Поэтому для достижения лучшей масштабируемости нам необходимо рассмотреть альтернативные библиотеки, которые поддерживают двумерную декомпозицию.

Слайд 8:

Прежде чем рассматривать параллельные библиотеки FFT, давайте разберем, что такое FFT. Быстрое преобразование Фурье — это алгоритм ускоренного вычисления дискретного преобразования Фурье со сложностью O(N log N). FFT считается одним из 10 важнейших алгоритмов XX века и шроко применяется в электронике, молекулярной динамике и других областях.

Слайд 9:

Параллельные библиотеки FFT используют в качестве backend однопроцессорные библиотеки для вычисления локальных FFT.

На слайде представлены наиболее распространенные библиотеки для одного устройства.

**Лидирующая библиотека:**

- **FFTW** — демонстрирует отличную производительность на различных архитектурах CPU

**Оптимизированные библиотеки от производителей:**

- **MKL** от Intel — для Intel CPU
- **ESSL** от IBM — для IBM CPU
- **rocFFT** от AMD — для AMD GPU
- **cuFFT** от NVIDIA — для NVIDIA GPU

Каждая библиотека оптимизирована под конкретную архитектуру производителя.

Слайд 10:

На этом слайде представлены основные библиотеки для распределенных вычислений.
Многие параллельные библиотеки изначально разрабатывались как расширения одноузловых библиотек. Например FFTW MPI. Но она подежривает только 1**D декомпозиция .**

**P3DFFT (Pekurovsky, 2012):**

- Самая известная библиотека с **Pencil-декомпозицией**
- CPU Backend: ESSL / FFTW
- Поддерживает **Slab и Pencil (1D и 2D)**

**PFFT (Pippig & Potts, 2013):**

- Дальнейшее развитие P3DFFT
- Производительность аналогична P3DFFT
- можно использовать для массивов более высоких размерностей.
- CPU Backend: FFTW
- Поддержка: Slab и Pencil

Слайд 11:

Современные библиотеки FFT демонстрируют не только превосходную производительность, но и поддержку распределенных вычислений на GPU.

AccFFT (2015) Первая библиотека для перекрытия вычислений и коллективных коммуникаций
• CPU Backend: FFTW  • GPU Backend: FFTW

fftMPI (2018)
Эффективное вычисление 3D FFT
• CPU Backend: FFTW / KISS / MKL
heFFTe (2020)
Самая универсальная библиотека: поддержка AMD, Intel, NVIDIA GPU
• можно использовать для массивов более высоких размерностей.
• CPU Backend: FFTW / MKL • GPU Backend: cuFFT / rocM / oneMKL
• поддержка декомпозицией: slab и pencil 1D 2D 3D slab pencil brick

Слайд 12:

Была найдена статья, сравнивающая производительность различных библиотек на суперкомпьютере Summit.

**Тестирование:** FFT размером 256³ на 4 узлах Summit

**Результаты:**

- **AccFFT** и **heFFTe** показали наилучшую производительность
- heFFTe с Pencil-декомпозицией особенно эффективна
- Все современные библиотеки превосходят FFTW MPI и P3DFFT

Слайд 13:

Для библиотеки heFFTe авторы провели масштабное тестирование на Summit.

**Тестирование:** до 1024 узлов Summit

heFFTe демонстрирует отличную масштабируемость на многоузловых системах и превосходную производительность на GPU. Это критично для будущей реализации распределенного кода на GPU.

Слайд 14: Почему современные библиотеки быстрее?
Главная проблема: Коммуникация занимает 40-60% времени выполнения (см. красный сегмент на графике).
Ключевое различие:
Современные библиотеки (AccFFT, heFFTe, fftMPI):

Неблокирующие коммуникации: MPI_Isend / MPI_Irecv
Перекрытие: упаковка данных во время коммуникации
Результат: меньше времени ожидания

Старые библиотеки (P3DFFT):

Блокирующая коммуникация: MPI_Alltoallv
Процессы ждут → нет перекрытия операций

План дальнейшей работы: Изучить современные библиотеки FFT и попробовать применить их в нашей кодовой реализации для повышения производительности.
